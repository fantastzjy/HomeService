<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title th:text="${wbeParameter.name}">注册</title>
    <link rel="stylesheet" href="../resource/common/layui/css/layui.css" media="all"/>
    <link rel="stylesheet" href="../resource/css/login(1).css" media="all"/>
    <link rel="stylesheet" href="../resource/css/public.css" media="all"/>
    <style>
        /* 覆盖原框架样式 */
        .layui-elem-quote {
            background-color: inherit !important;
        }

        .layui-input, .layui-select, .layui-textarea {
            background-color: inherit;
            padding-left: 30px;
        }
    </style>
</head>
<body th:style="${'background: url('+loginReg.regBackground+')'}">


<!-- LoginForm -->
<div class="zyl_lofo_main" style="background-color:rgba(0,0,0,0);left: 34%;top: 10%">
    <fieldset class="layui-elem-field layui-field-title zyl_mar_02">
        <legend style="font-size: x-large;color: rgba(255, 255, 255, 1);font-size: 33px;font-weight: 400;">Register an
            account
        </legend>
    </fieldset>
    <div class="layui-row layui-col-space15">
        <div class="layui-form zyl_pad_01" action="">
            <div class="layui-col-sm12 layui-col-md12">
                <div class="layui-form-item">
                    <input type="text" name="userName" lay-verify="required|userName" autocomplete="off"
                           placeholder="账号" class="layui-input" style="background-color: #FFFFFF;width: 100%">
                    <i class="layui-icon layui-icon-username zyl_lofo_icon"></i>
                </div>
            </div>
            <div class="layui-col-sm12 layui-col-md12">
                <div class="layui-form-item">
                    <input type="password" name="plainPassword" lay-verify="required|pass" autocomplete="off"
                           placeholder="密码"
                           class="layui-input" style="background-color: #FFFFFF;width: 100%">
                    <i class="layui-icon layui-icon-password zyl_lofo_icon"></i>
                </div>
            </div>
            <div class="layui-col-sm12 layui-col-md12" th:if="${loginReg.isRealName eq 'on'}">
                <div class="layui-form-item">
                    <input type="text" name="realName" lay-verify="required" autocomplete="off"
                           placeholder="真实姓名"
                           class="layui-input" style="background-color: #FFFFFF;width: 100%">
                    <i class="layui-icon layui-icon-username zyl_lofo_icon"></i>
                </div>
            </div>
            <div class="layui-col-sm12 layui-col-md12" th:if="${loginReg.isEmail eq 'on'}">
                <div class="layui-form-item">
                    <input type="text" name="email" lay-verify="required|email" autocomplete="off"
                           placeholder="邮件"
                           class="layui-input" style="background-color: #FFFFFF;width: 100%">
                    <i class="layui-icon layui-icon-reply-fill zyl_lofo_icon"></i>
                </div>
            </div>
            <div class="layui-col-sm12 layui-col-md12" th:if="${loginReg.isPhone eq 'on'}">
                <div class="layui-form-item">
                    <input type="text" name="iphone" lay-verify="required|phone" autocomplete="off"
                           placeholder="联系方式"
                           class="layui-input" style="background-color: #FFFFFF;width: 100%">
                    <i class="layui-icon layui-icon-cellphone zyl_lofo_icon"></i>
                </div>
            </div>
            <div class="layui-col-sm12 layui-col-md12" th:if="${loginReg.isIdCard eq 'on'}">
                <div class="layui-form-item">
                    <input type="text" name="idCard" lay-verify="required|identity" autocomplete="off"
                           placeholder="身份证"
                           class="layui-input" style="background-color: #FFFFFF;width: 100%">
                    <i class="layui-icon layui-icon-auz zyl_lofo_icon"></i>
                </div>
            </div>
            <div class="layui-col-sm12 layui-col-md12" th:if="${loginReg.isAddress eq 'on'}">
                <div class="layui-form-item">
                    <input type="text" name="address" lay-verify="required" autocomplete="off"
                           placeholder="联系地址"
                           class="layui-input" style="background-color: #FFFFFF;width: 100%">
                    <i class="layui-icon layui-icon-location zyl_lofo_icon"></i>
                </div>
            </div>
            <div class="layui-col-sm12 layui-col-md12" th:if="${loginReg.isSex eq 'on'}">
                <div class="layui-form-item" style="background-color: #FFFFFF;width: 100%">
                    <select name="sex">
                        <option>男</option>
                        <option>女</option>
                    </select>
                    <i class="layui-icon layui-icon-male zyl_lofo_icon"></i>
                </div>
            </div>
            <div class="layui-col-sm12 layui-col-md12" th:if="${loginReg.isImg eq 'on'}">
                <div class="layui-form-item">
                    <input type="text" name="imgUrl" lay-verify="required" id="imgUrl" readonly autocomplete="off"
                           placeholder="头像"
                           class="layui-input" style="background-color: #FFFFFF;width: 100%">
                    <i class="layui-icon layui-icon-picture-fine zyl_lofo_icon"></i>
                </div>
            </div>
            <div class="layui-col-sm12 layui-col-md12">
                <button class="layui-btn layui-btn-fluid" lay-submit="" lay-filter="demo1">立即注册</button>
            </div>
            <div class="layui-col-sm12 layui-col-md12" style="margin-top: 20px;">
                <div class="layui-form-item">
                    <a href="/login.do" style="color: rgba(255, 255, 255, 1)">已有账号，去登陆</a>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- LoginForm End -->


<!-- Jquery Js -->
<script src="/resource/js/config/jquery-1.7.2.min.js" type="text/javascript"></script>
<!-- Layui Js -->
<script type="text/javascript" src="/resource/common/layui/layui.js"></script>

<script>
    layui.use(['carousel', 'form', 'upload',], function () {
        var carousel = layui.carousel
            , upload = layui.upload
            , form = layui.form;
        upload.render({
            elem: '#imgUrl'
            , url: '/upload.do'
            , done: function (res) {
                //如果上传失败
                if (res.code > 0) {
                    return layer.msg('上传失败');
                }
                $("#imgUrl").val(res.obje);
                return layer.msg('上传成功');
            }
            , error: function () {
                return layer.msg('上传失败');
            }
        });
        //自定义验证规则
        form.verify({
            userName: function (value) {
                if (value.length < 5) {
                    return '账号至少得5个字符';
                }
            }
            , pass: [/^[\S]{4,12}$/, '密码必须6到12位，且不能出现空格']
            , content: function (value) {
                layedit.sync(editIndex);
            }
        });

        //监听提交
        form.on('submit(demo1)', function (data) {
            $.ajax({
                url: '/user/userRegister.do',
                type: 'post',
                dataType: 'json',
                data: data.field,
                async: false,
                success: function (result) {
                    console.log(result)
                    if (result.status) {
                        alert("注册成功！")
                        location.href = "/loginShiro";
                    } else {
                        layer.msg(result.msg, {time: 2000});
                    }
                }

            });
        });
    });

</script>
</body>
</html>
